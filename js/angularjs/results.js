// Generated by CoffeeScript 1.3.3
(function() {

  window.ResultsCtrl = [
    '$scope', '$filter', function(self, $filter) {
      var action, f, field, fields, i, value, _i, _j, _len, _len1, _ref, _ref1;
      fields = [];
      _ref = self.fields;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        field = _ref[_i];
        value = self.incident.getValue(field.key);
        f = {
          name: field.label
        };
        if (typeof value === 'string') {
          f.values = [value];
        } else {
          f.values = value;
        }
        fields.push(f);
      }
      _ref1 = self.incident.actions;
      for (i = _j = 0, _len1 = _ref1.length; _j < _len1; i = ++_j) {
        action = _ref1[i];
        fields.push({
          name: "Description of Corrective Action (" + i + ")",
          value: action.description
        });
        fields.push({
          name: "Action Taken By (name) (" + i + ")",
          value: action.name
        });
        fields.push({
          name: "Company (" + i + ")",
          value: action.company
        });
        fields.push({
          name: "Date (" + i + ")",
          value: action.date
        });
      }
      return self.result = {
        workflowCreationInformation: {
          workflowTypeName: "Incident Report",
          name: "Report - " + $filter('date')(new Date(), 'yyyy.MM.dd')
        },
        workflowStepUpdateInformation: {
          stepIdOrName: "Initial Step",
          fields: fields
        }
      };
    }
  ];

}).call(this);
